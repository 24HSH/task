<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="oms.bankAcct">
	
	<typeAlias alias="bankAcct" type="com.hsh24.sync.api.oms.bo.BankAcct" />
	
	<update id="updateBankAcct" parameterClass="bankAcct">
	<![CDATA[
		UPDATE dms_tb_bank_account t, dms_tb_trade p, dms_tb_account q
		   SET t.modify_date = NOW(),
			   t.modify_user = #modifyUser#,
			   t.cur_bal = t.cur_bal + p.trade_price
		WHERE t.shop_id = p.shop_id
			AND p.shop_id = q.shop_id
			AND t.acc_id = q.acc_id
			AND q.acc_code = '1001'
			AND t.state = 'U'
			AND p.state = 'U'
			AND q.state = 'U'
			AND p.trade_id = #tradeId#
	]]>
	</update>
	
</sqlMap>