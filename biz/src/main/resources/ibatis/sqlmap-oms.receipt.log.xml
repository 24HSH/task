<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="oms.receipt.log">
	
	<typeAlias alias="receiptLog" type="com.hsh24.sync.api.oms.bo.ReceiptLog" />
	
	<select id="getReceiptLogList" parameterClass="receiptLog" resultClass="receiptLog">
	<![CDATA[
		SELECT ID,
			   RECEIPT_ID AS receiptId,
			   TYPE
		  FROM dms.dms_tb_receipt_log
		 WHERE STATE= 'U'
		 AND times < 3
		 ORDER BY MODIFY_DATE
		 LIMIT 10
	]]>
	</select>

	<update id="finishReceiptLog" parameterClass="receiptLog">
	<![CDATA[
		UPDATE dms.dms_tb_receipt_log t
		   SET t.STATE = 'D',
			   t.MODIFY_DATE = NOW(),
			   t.MODIFY_USER = #modifyUser#
		 WHERE t.id = #id#
		   AND t.STATE = 'U'
	]]>
	</update>
	
	<update id="recordReceiptLog" parameterClass="receiptLog">
	<![CDATA[
		UPDATE dms.dms_tb_receipt_log t
		   SET t.times = t.times + 1,
			   t.e = #e#,
			   t.MODIFY_DATE = NOW(),
			   t.MODIFY_USER = #modifyUser#
		 WHERE t.id = #id#
		   AND t.STATE = 'U'
	]]>
	</update>
	
</sqlMap>
	