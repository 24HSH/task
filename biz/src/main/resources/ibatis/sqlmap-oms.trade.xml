<?xml version="1.0" encoding="GB2312"?>
<!DOCTYPE sqlMap
	PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
	"http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="oms.trade">
	
	<typeAlias alias="omsTrade" type="com.hsh24.sync.api.oms.bo.Trade" />
	
	<update id="sync2Send">
	<![CDATA[
		UPDATE dms.dms_tb_trade t,
			   oms.pur_order_t o
		   SET t.TYPE = 'send',
			   t.MODIFY_DATE = NOW(),
			   t.MODIFY_USER = 'sys'
		 WHERE t.TRADE_NO = o.purchase_cd
		   AND o.purchase_status = '0003'
		   AND t.TYPE = 'tosend'
		   AND t.STATE = 'U'
	]]>
	</update>
	
	<select id="getTrade" parameterClass="omsTrade" resultClass="omsTrade">
	<![CDATA[
		SELECT t.trade_id AS tradeId,
			   t.trade_no AS tradeNo,
			   t.sup_id AS supId,
			   t.type,
			   t.trade_price AS tradePrice,
			   DATE_FORMAT(t.create_date, '%Y-%m-%d %T') AS createDate,
			   t.create_user AS createUser,
			   t.modify_user AS modifyUser
		  FROM dms.dms_tb_trade t
		 WHERE t.trade_id = #tradeId#
	]]>
	</select>
	
</sqlMap>